{"ast":null,"code":"var _jsxFileName = \"D:\\\\voting\\\\voting_app\\\\frontend\\\\src\\\\components\\\\GoogleSignIn.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst GoogleSignIn = ({\n  onSuccess,\n  onError,\n  loading,\n  buttonText = \"Continue with Google\"\n}) => {\n  _s();\n  const [googleReady, setGoogleReady] = useState(false);\n  const [hasValidClientId, setHasValidClientId] = useState(false);\n  useEffect(() => {\n    // Check if we have a valid Google Client ID\n    const clientId = process.env.REACT_APP_GOOGLE_CLIENT_ID;\n    console.log(\"Loaded Google Client ID:\", clientId); // DEBUG LOG\n    const isValidClientId = clientId && clientId !== \"your_google_client_id_here\" && clientId !== \"your-google-client-id\" && clientId.length > 10;\n    setHasValidClientId(isValidClientId);\n\n    // Only load Google script if we have a valid client ID\n    if (isValidClientId) {\n      // Load Google Identity Services script\n      const script = document.createElement(\"script\");\n      script.src = \"https://accounts.google.com/gsi/client\";\n      script.async = true;\n      script.defer = true;\n      document.head.appendChild(script);\n      script.onload = () => {\n        if (window.google) {\n          try {\n            window.google.accounts.id.initialize({\n              client_id: clientId,\n              callback: handleCredentialResponse\n            });\n            setGoogleReady(true);\n          } catch (error) {\n            console.error(\"Google OAuth initialization error:\", error);\n            setGoogleReady(false);\n          }\n        }\n      };\n      script.onerror = () => {\n        console.error(\"Failed to load Google Identity Services\");\n        setGoogleReady(false);\n      };\n      return () => {\n        // Cleanup\n        const existingScript = document.querySelector('script[src=\"https://accounts.google.com/gsi/client\"]');\n        if (existingScript) {\n          document.head.removeChild(existingScript);\n        }\n      };\n    }\n  }, []);\n  const handleCredentialResponse = async response => {\n    try {\n      // Decode the JWT token to get user info\n      const userInfo = parseJwt(response.credential);\n      const userData = {\n        credential: response.credential,\n        name: userInfo.name,\n        email: userInfo.email,\n        picture: userInfo.picture\n      };\n\n      // Send to backend\n      const backendResponse = await axios.post(\"/api/auth/google\", userData);\n      if (onSuccess) {\n        onSuccess(backendResponse.data);\n      }\n    } catch (error) {\n      console.error(\"Google sign-in error:\", error);\n      if (onError) {\n        var _error$response, _error$response$data;\n        onError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || \"Google sign-in failed\");\n      }\n    }\n  };\n  const parseJwt = token => {\n    try {\n      const base64Url = token.split(\".\")[1];\n      const base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n      const jsonPayload = decodeURIComponent(atob(base64).split(\"\").map(function (c) {\n        return \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2);\n      }).join(\"\"));\n      return JSON.parse(jsonPayload);\n    } catch (error) {\n      console.error(\"Error parsing JWT:\", error);\n      return {};\n    }\n  };\n  const handleGoogleSignIn = () => {\n    if (hasValidClientId && googleReady && window.google) {\n      // Use real Google OAuth\n      try {\n        window.google.accounts.id.prompt();\n      } catch (error) {\n        console.error(\"Google sign-in prompt error:\", error);\n        handleDemoSignIn();\n      }\n    } else {\n      // Fallback to demo mode if Google SDK not loaded or no valid client ID\n      console.log(\"Using demo Google sign-in (no valid client ID configured)\");\n      handleDemoSignIn();\n    }\n  };\n  const handleDemoSignIn = async () => {\n    try {\n      const demoUserData = {\n        name: \"Demo Google User\",\n        email: \"demo@gmail.com\",\n        picture: \"https://via.placeholder.com/150\"\n      };\n      const response = await axios.post(\"/api/auth/google\", demoUserData);\n      if (onSuccess) {\n        onSuccess(response.data);\n      }\n    } catch (error) {\n      console.error(\"Demo Google sign-in error:\", error);\n      if (onError) {\n        var _error$response2, _error$response2$data;\n        onError(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || \"Demo Google sign-in failed\");\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: handleGoogleSignIn,\n    className: \"btn btn-outline btn-full\",\n    disabled: loading,\n    title: hasValidClientId ? \"Sign in with Google\" : \"Demo Google Sign-in (no client ID configured)\",\n    children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 11\n      }, this), \"Signing in with Google...\"]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fab fa-google\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 11\n      }, this), hasValidClientId ? buttonText : `${buttonText} (Demo)`]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 149,\n    columnNumber: 5\n  }, this);\n};\n_s(GoogleSignIn, \"/MgQWL7AVonZBmlDvpSFU8JVayo=\");\n_c = GoogleSignIn;\nexport default GoogleSignIn;\nvar _c;\n$RefreshReg$(_c, \"GoogleSignIn\");","map":{"version":3,"names":["React","useEffect","useState","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","GoogleSignIn","onSuccess","onError","loading","buttonText","_s","googleReady","setGoogleReady","hasValidClientId","setHasValidClientId","clientId","process","env","REACT_APP_GOOGLE_CLIENT_ID","console","log","isValidClientId","length","script","document","createElement","src","async","defer","head","appendChild","onload","window","google","accounts","id","initialize","client_id","callback","handleCredentialResponse","error","onerror","existingScript","querySelector","removeChild","response","userInfo","parseJwt","credential","userData","name","email","picture","backendResponse","post","data","_error$response","_error$response$data","message","token","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","handleGoogleSignIn","prompt","handleDemoSignIn","demoUserData","_error$response2","_error$response2$data","onClick","className","disabled","title","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/voting/voting_app/frontend/src/components/GoogleSignIn.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\nconst GoogleSignIn = ({\n  onSuccess,\n  onError,\n  loading,\n  buttonText = \"Continue with Google\",\n}) => {\n  const [googleReady, setGoogleReady] = useState(false);\n  const [hasValidClientId, setHasValidClientId] = useState(false);\n\n  useEffect(() => {\n    // Check if we have a valid Google Client ID\n    const clientId = process.env.REACT_APP_GOOGLE_CLIENT_ID;\n    console.log(\"Loaded Google Client ID:\", clientId); // DEBUG LOG\n    const isValidClientId =\n      clientId &&\n      clientId !== \"your_google_client_id_here\" &&\n      clientId !== \"your-google-client-id\" &&\n      clientId.length > 10;\n\n    setHasValidClientId(isValidClientId);\n\n    // Only load Google script if we have a valid client ID\n    if (isValidClientId) {\n      // Load Google Identity Services script\n      const script = document.createElement(\"script\");\n      script.src = \"https://accounts.google.com/gsi/client\";\n      script.async = true;\n      script.defer = true;\n      document.head.appendChild(script);\n\n      script.onload = () => {\n        if (window.google) {\n          try {\n            window.google.accounts.id.initialize({\n              client_id: clientId,\n              callback: handleCredentialResponse,\n            });\n            setGoogleReady(true);\n          } catch (error) {\n            console.error(\"Google OAuth initialization error:\", error);\n            setGoogleReady(false);\n          }\n        }\n      };\n\n      script.onerror = () => {\n        console.error(\"Failed to load Google Identity Services\");\n        setGoogleReady(false);\n      };\n\n      return () => {\n        // Cleanup\n        const existingScript = document.querySelector(\n          'script[src=\"https://accounts.google.com/gsi/client\"]'\n        );\n        if (existingScript) {\n          document.head.removeChild(existingScript);\n        }\n      };\n    }\n  }, []);\n\n  const handleCredentialResponse = async (response) => {\n    try {\n      // Decode the JWT token to get user info\n      const userInfo = parseJwt(response.credential);\n\n      const userData = {\n        credential: response.credential,\n        name: userInfo.name,\n        email: userInfo.email,\n        picture: userInfo.picture,\n      };\n\n      // Send to backend\n      const backendResponse = await axios.post(\"/api/auth/google\", userData);\n\n      if (onSuccess) {\n        onSuccess(backendResponse.data);\n      }\n    } catch (error) {\n      console.error(\"Google sign-in error:\", error);\n      if (onError) {\n        onError(error.response?.data?.message || \"Google sign-in failed\");\n      }\n    }\n  };\n\n  const parseJwt = (token) => {\n    try {\n      const base64Url = token.split(\".\")[1];\n      const base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n      const jsonPayload = decodeURIComponent(\n        atob(base64)\n          .split(\"\")\n          .map(function (c) {\n            return \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2);\n          })\n          .join(\"\")\n      );\n      return JSON.parse(jsonPayload);\n    } catch (error) {\n      console.error(\"Error parsing JWT:\", error);\n      return {};\n    }\n  };\n\n  const handleGoogleSignIn = () => {\n    if (hasValidClientId && googleReady && window.google) {\n      // Use real Google OAuth\n      try {\n        window.google.accounts.id.prompt();\n      } catch (error) {\n        console.error(\"Google sign-in prompt error:\", error);\n        handleDemoSignIn();\n      }\n    } else {\n      // Fallback to demo mode if Google SDK not loaded or no valid client ID\n      console.log(\"Using demo Google sign-in (no valid client ID configured)\");\n      handleDemoSignIn();\n    }\n  };\n\n  const handleDemoSignIn = async () => {\n    try {\n      const demoUserData = {\n        name: \"Demo Google User\",\n        email: \"demo@gmail.com\",\n        picture: \"https://via.placeholder.com/150\",\n      };\n\n      const response = await axios.post(\"/api/auth/google\", demoUserData);\n\n      if (onSuccess) {\n        onSuccess(response.data);\n      }\n    } catch (error) {\n      console.error(\"Demo Google sign-in error:\", error);\n      if (onError) {\n        onError(error.response?.data?.message || \"Demo Google sign-in failed\");\n      }\n    }\n  };\n\n  return (\n    <button\n      onClick={handleGoogleSignIn}\n      className=\"btn btn-outline btn-full\"\n      disabled={loading}\n      title={\n        hasValidClientId\n          ? \"Sign in with Google\"\n          : \"Demo Google Sign-in (no client ID configured)\"\n      }\n    >\n      {loading ? (\n        <>\n          <div className=\"spinner\"></div>\n          Signing in with Google...\n        </>\n      ) : (\n        <>\n          <i className=\"fab fa-google\"></i>\n          {hasValidClientId ? buttonText : `${buttonText} (Demo)`}\n        </>\n      )}\n    </button>\n  );\n};\n\nexport default GoogleSignIn;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}